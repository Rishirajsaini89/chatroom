(this["webpackJsonpreact-messenger"]=this["webpackJsonpreact-messenger"]||[]).push([[0],{55:function(e,t,a){},56:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var c=a(8),n=a.n(c),r=a(44),s=a.n(r),i=(a(55),a(56),a(27)),l=a(16),j=a(0),o=a.n(j),u=a(1),b=a(12),d=a(45),O=a(28),x=a(11),m=a(20),h={apiKey:"AIzaSyAeRHorYzVRtPspEx0co18hE9YrC_S2NLw",authDomain:"react-chatting-website.firebaseapp.com",databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_DATABASE_URL,projectId:"react-chatting-website",storageBucket:"react-chatting-website.appspot.com",messagingSenderId:"1054244648189",appId:"1:1054244648189:web:829a47700743afebd37a94"},p=Object(d.a)(h),f=Object(O.b)(p),v=Object(x.f)(p),g=Object(m.c)(p),w=a.p+"static/media/image1.f02b66c0.jpg",N=a(5),_=function(e){var t=e.user1,a=e.user,n=e.selectUser,r=e.chat,s=null===a||void 0===a?void 0:a.uid,i=Object(c.useState)(""),l=Object(b.a)(i,2),j=l[0],o=l[1];return Object(c.useEffect)((function(){var e="".concat(t>s?t+s:s+t),a=Object(x.g)(Object(x.d)(v,"lastMsg",e),(function(e){o(e.data())}));return function(){return a()}}),[]),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"user_wrapper ".concat(r.name===a.name&&"selected_user"),onClick:function(){return n(a)},children:[Object(N.jsxs)("div",{className:"user_info",children:[Object(N.jsxs)("div",{className:"user_detail",children:[Object(N.jsx)("img",{src:a.avatar||w,alt:"avatar",className:"avatar"}),Object(N.jsx)("h4",{children:a.name}),(null===j||void 0===j?void 0:j.from)!==t&&(null===j||void 0===j?void 0:j.unread)&&Object(N.jsx)("small",{className:"unread",children:"New"})]}),Object(N.jsx)("div",{className:"user_status ".concat(a.isOnline?"online":"offline")})]}),j&&Object(N.jsxs)("p",{className:"truncate",children:[Object(N.jsx)("strong",{children:j.from===t?"Me:":null}),j.text]})]}),Object(N.jsx)("div",{onClick:function(){return n(a)},className:"sm_container ".concat(r.name===a.name&&"selected_user"),children:Object(N.jsx)("img",{src:a.avatar||w,alt:"avatar",className:"avatar sm_screen"})})]})},S=function(){return Object(N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer",color:"gray"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(N.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})})},y=function(e){var t=e.handleSubmit,a=e.text,c=e.setText,n=e.setImg;return Object(N.jsxs)("form",{className:"message_form",onSubmit:t,children:[Object(N.jsx)("label",{htmlFor:"img",children:Object(N.jsx)(S,{})}),Object(N.jsx)("input",{onChange:function(e){return n(e.target.files[0])},type:"file",id:"img",accept:"image/*",style:{display:"none"}}),Object(N.jsx)("div",{children:Object(N.jsx)("input",{type:"text",placeholder:"Enter message",value:a,onChange:function(e){return c(e.target.value)}})}),Object(N.jsx)("div",{children:Object(N.jsx)("button",{className:"btn",children:"Send"})})]})},k=a(46),C=a.n(k),A=function(e){var t=e.msg,a=e.user1,n=Object(c.useRef)();return Object(c.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[t]),Object(N.jsx)("div",{className:"message_wrapper ".concat(t.from===a?"own":""),ref:n,children:Object(N.jsxs)("p",{className:t.from===a?"me":"friend",children:[t.media?Object(N.jsx)("img",{src:t.media,alt:t.text}):null,t.text,Object(N.jsx)("br",{}),Object(N.jsx)("small",{children:Object(N.jsx)(C.a,{fromNow:!0,children:t.createdAt.toDate()})})]})})},E=function(){var e=Object(c.useState)([]),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(""),s=Object(b.a)(r,2),i=s[0],l=s[1],j=Object(c.useState)(""),d=Object(b.a)(j,2),O=d[0],h=d[1],p=Object(c.useState)(""),w=Object(b.a)(p,2),S=w[0],k=w[1],C=Object(c.useState)([]),E=Object(b.a)(C,2),D=E[0],P=E[1],R=f.currentUser.uid;Object(c.useEffect)((function(){var e=Object(x.c)(v,"users"),t=Object(x.i)(e,Object(x.l)("uid","not-in",[R])),a=Object(x.g)(t,(function(e){var t=[];e.forEach((function(e){t.push(e.data())})),n(t)}));return function(){return a()}}),[]);var L=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,c,n,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t),a=t.uid,c="".concat(R>a?R+a:a+R),n=Object(x.c)(v,"messages",c,"chat"),r=Object(x.i)(n,Object(x.h)("createdAt","asc")),Object(x.g)(r,(function(e){var t=[];e.forEach((function(e){t.push(e.data())})),P(t)})),e.next=8,Object(x.e)(Object(x.d)(v,"lastMsg",c));case 8:if(!(s=e.sent).data()||s.data().from===R){e.next=12;break}return e.next=12,Object(x.k)(Object(x.d)(v,"lastMsg",c),{unread:!1});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,c,n,r,s,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=i.uid,c="".concat(R>a?R+a:a+R),!S){e.next=12;break}return r=Object(m.d)(g,"images/".concat((new Date).getTime()," - ").concat(S.name)),e.next=7,Object(m.e)(r,S);case 7:return s=e.sent,e.next=10,Object(m.b)(Object(m.d)(g,s.ref.fullPath));case 10:l=e.sent,n=l;case 12:return e.next=14,Object(x.b)(Object(x.c)(v,"messages",c,"chat"),{text:O,from:R,to:a,createdAt:x.a.fromDate(new Date),media:n||""});case 14:return e.next=16,Object(x.j)(Object(x.d)(v,"lastMsg",c),{text:O,from:R,to:a,createdAt:x.a.fromDate(new Date),media:n||"",unread:!0});case 16:h(""),k("");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsxs)("div",{className:"home_container",children:[Object(N.jsx)("div",{className:"users_container",children:a.map((function(e){return Object(N.jsx)(_,{user:e,selectUser:L,user1:R,chat:i},e.uid)}))}),Object(N.jsx)("div",{className:"messages_container",children:i?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"messages_user",children:Object(N.jsx)("h3",{children:i.name})}),Object(N.jsx)("div",{className:"messages",children:D.length?D.map((function(e,t){return Object(N.jsx)(A,{msg:e,user1:R},t)})):null}),Object(N.jsx)(y,{handleSubmit:F,text:O,setText:h,setImg:k})]}):Object(N.jsx)("h3",{className:"no_conv",children:"Select a user to start conversation"})})]})},D=function(){return Object(N.jsx)("div",{style:{position:"relative"},children:Object(N.jsx)("h2",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:"Loading..."})})},P=Object(c.createContext)(),R=function(e){var t=e.children,a=Object(c.useState)(null),n=Object(b.a)(a,2),r=n[0],s=n[1],i=Object(c.useState)(!0),l=Object(b.a)(i,2),j=l[0],o=l[1];return Object(c.useEffect)((function(){Object(O.c)(f,(function(e){s(e),o(!1)}))}),[]),j?Object(N.jsx)(D,{}):Object(N.jsx)(P.Provider,{value:{user:r},children:t})},L=function(){var e=Object(l.g)(),t=Object(c.useContext)(P).user,a=function(){var t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(x.k)(Object(x.d)(v,"users",f.currentUser.uid),{isOnline:!1});case 2:return t.next=4,Object(O.e)(f);case 4:e.replace("/login");case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(N.jsxs)("nav",{children:[Object(N.jsx)("h3",{children:Object(N.jsx)(i.b,{to:"/",children:"Messenger"})}),Object(N.jsx)("div",{children:t?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(i.b,{to:"/profile",children:"Profile"}),Object(N.jsx)("button",{className:"btn",onClick:a,children:"Logout"})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(i.b,{to:"/register",children:"Register"}),Object(N.jsx)(i.b,{to:"/login",children:"Login"})]})})]})},F=a(4),T=a(15),M=function(){var e=Object(c.useState)({name:"",email:"",password:"",error:null,loading:!1}),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(l.g)(),s=a.name,i=a.email,j=a.password,d=a.error,m=a.loading,h=function(e){n(Object(T.a)(Object(T.a)({},a),{},Object(F.a)({},e.target.name,e.target.value)))},p=function(){var e=Object(u.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n(Object(T.a)(Object(T.a)({},a),{},{error:null,loading:!0})),s&&i&&j||n(Object(T.a)(Object(T.a)({},a),{},{error:"All fields are required"})),e.prev=3,e.next=6,Object(O.a)(f,i,j);case 6:return c=e.sent,e.next=9,Object(x.j)(Object(x.d)(v,"users",c.user.uid),{uid:c.user.uid,name:s,email:i,createdAt:x.a.fromDate(new Date),isOnline:!0});case 9:n({name:"",email:"",password:"",error:null,loading:!1}),r.replace("/"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n(Object(T.a)(Object(T.a)({},a),{},{error:e.t0.message,loading:!1}));case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsxs)("section",{children:[Object(N.jsx)("h3",{children:"Create An Account"}),Object(N.jsxs)("form",{className:"form",onSubmit:p,children:[Object(N.jsxs)("div",{className:"input_container",children:[Object(N.jsx)("label",{htmlFor:"name",children:"Name"}),Object(N.jsx)("input",{type:"text",name:"name",value:s,onChange:h})]}),Object(N.jsxs)("div",{className:"input_container",children:[Object(N.jsx)("label",{htmlFor:"email",children:"Email"}),Object(N.jsx)("input",{type:"text",name:"email",value:i,onChange:h})]}),Object(N.jsxs)("div",{className:"input_container",children:[Object(N.jsx)("label",{htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{type:"password",name:"password",value:j,onChange:h})]}),d?Object(N.jsx)("p",{className:"error",children:d}):null,Object(N.jsx)("div",{className:"btn_container",children:Object(N.jsx)("button",{className:"btn",disabled:m,children:m?"Creating ...":"Register"})})]})]})},I=function(){var e=Object(c.useState)({email:"",password:"",error:null,loading:!1}),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(l.g)(),s=a.email,i=a.password,j=a.error,d=a.loading,m=function(e){n(Object(T.a)(Object(T.a)({},a),{},Object(F.a)({},e.target.name,e.target.value)))},h=function(){var e=Object(u.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n(Object(T.a)(Object(T.a)({},a),{},{error:null,loading:!0})),s&&i||n(Object(T.a)(Object(T.a)({},a),{},{error:"All fields are required"})),e.prev=3,e.next=6,Object(O.d)(f,s,i);case 6:return c=e.sent,e.next=9,Object(x.k)(Object(x.d)(v,"users",c.user.uid),{isOnline:!0});case 9:n({email:"",password:"",error:null,loading:!1}),r.replace("/"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n(Object(T.a)(Object(T.a)({},a),{},{error:e.t0.message,loading:!1}));case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsx)("div",{className:"abcd",children:Object(N.jsxs)("section",{children:[Object(N.jsx)("h3",{children:"Log into your Account"}),Object(N.jsxs)("form",{className:"form",onSubmit:h,children:[Object(N.jsxs)("div",{className:"input_container",children:[Object(N.jsx)("label",{htmlFor:"email",children:"Email"}),Object(N.jsx)("input",{type:"text",name:"email",value:s,onChange:m})]}),Object(N.jsxs)("div",{className:"input_container",children:[Object(N.jsx)("label",{htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{type:"password",name:"password",value:i,onChange:m})]}),j?Object(N.jsx)("p",{className:"error",children:j}):null,Object(N.jsx)("div",{className:"btn_container",children:Object(N.jsx)("button",{className:"btn",disabled:d,children:d?"Logging in ...":"Login"})})]})]})})},U=function(){return Object(N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(N.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})},z=function(e){var t=e.deleteImage;return Object(N.jsx)("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer",color:"#f24957"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(N.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})},H=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(),s=Object(b.a)(r,2),i=s[0],j=s[1],d=Object(l.g)("");Object(c.useEffect)((function(){if(Object(x.e)(Object(x.d)(v,"users",f.currentUser.uid)).then((function(e){e.exists&&j(e.data())})),a){var e=function(){var e=Object(u.a)(o.a.mark((function e(){var t,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(m.d)(g,"avatar/".concat((new Date).getTime()," - ").concat(a.name)),e.prev=1,!i.avatarPath){e.next=5;break}return e.next=5,Object(m.a)(Object(m.d)(g,i.avatarPath));case 5:return e.next=7,Object(m.e)(t,a);case 7:return c=e.sent,e.next=10,Object(m.b)(Object(m.d)(g,c.ref.fullPath));case 10:return r=e.sent,e.next=13,Object(x.k)(Object(x.d)(v,"users",f.currentUser.uid),{avatar:r,avatarPath:c.ref.fullPath});case 13:n(""),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();e()}}),[a]);var O=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.confirm("Delete avatar?")){e.next=8;break}return e.next=5,Object(m.a)(Object(m.d)(g,i.avatarPath));case 5:return e.next=7,Object(x.k)(Object(x.d)(v,"users",f.currentUser.uid),{avatar:"",avatarPath:""});case 7:d.replace("/");case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return i?Object(N.jsx)("section",{children:Object(N.jsxs)("div",{className:"profile_container",children:[Object(N.jsxs)("div",{className:"img_container",children:[Object(N.jsx)("img",{src:i.avatar||w,alt:"avatar"}),Object(N.jsx)("div",{className:"overlay",children:Object(N.jsxs)("div",{children:[Object(N.jsx)("label",{htmlFor:"photo",children:Object(N.jsx)(U,{})}),i.avatar?Object(N.jsx)(z,{deleteImage:O}):null,Object(N.jsx)("input",{type:"file",accept:"image/*",style:{display:"none"},id:"photo",onChange:function(e){return n(e.target.files[0])}})]})})]}),Object(N.jsxs)("div",{className:"text_container",children:[Object(N.jsx)("h3",{children:i.name}),Object(N.jsx)("p",{children:i.email}),Object(N.jsx)("hr",{}),Object(N.jsxs)("small",{children:["Joined on: ",i.createdAt.toDate().toDateString()]})]})]})}):null},V=a(49),B=["component"],K=function(e){var t=e.component,a=Object(V.a)(e,B),n=Object(c.useContext)(P).user;return Object(N.jsx)(l.b,Object(T.a)(Object(T.a)({},a),{},{exact:!0,render:function(e){return n?Object(N.jsx)(t,Object(T.a)({},e)):Object(N.jsx)(l.a,{to:"/login"})}}))};var J=function(){return Object(N.jsx)(R,{children:Object(N.jsxs)(i.a,{children:[Object(N.jsx)(L,{}),Object(N.jsxs)(l.d,{children:[Object(N.jsx)(l.b,{exact:!0,path:"/register",component:M}),Object(N.jsx)(l.b,{exact:!0,path:"/login",component:I}),Object(N.jsx)(K,{exact:!0,path:"/profile",component:H}),Object(N.jsx)(K,{exact:!0,path:"/",component:E})]})]})})};s.a.render(Object(N.jsx)(n.a.StrictMode,{children:Object(N.jsx)(J,{})}),document.getElementById("root"))}},[[66,1,2]]]);
//# sourceMappingURL=main.e0773f78.chunk.js.map